generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model QuizResponse {
  id          String   @id @default(cuid())
  email       String
  answers     Json
  birthDate   Json
  birthPlace  String?
  birthTime   String?
  firstName   String?
  lastName    String?
  gender      String?
  coverDesign String?
  createdAt   DateTime @default(now())
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  name      String?
  createdAt DateTime @default(now())
  chartImages ChartImage[]
  natalChartInterpretations NatalChartInterpretation[]
}

model ChartImage {
  id        String   @id @default(cuid())
  user      User?    @relation(fields: [userId], references: [id])
  userId    Int?
  email     String?
  session_id String?
  imageUrl  String
  birthData Json
  chartType String?  // e.g., 'natal', 'solar return', etc.
  createdAt DateTime @default(now())
  natalChartInterpretations NatalChartInterpretation[]
}

model NatalChartInterpretation {
  id                      String   @id @default(uuid())
  userId                  Int?
  chartImageId            String?
  session_id              String?
  planets                 Json?
  houses                  Json?
  ascendant               Float?
  midheaven               Float?
  vertex                  Float?
  lilith                  Json?
  aspects                 Json?
  moon_phase_name         String?
  moon_phase_description  String?
  hemisphere_east_west    String?
  hemisphere_north_south  String?
  elements                Json?
  elements_description    String?
  modes                   Json?
  modes_description       String?
  dominant_sign           Json?
  sun_sign                String?
  moon_sign               String?
  created_at              DateTime @default(now())
  user                    User?    @relation(fields: [userId], references: [id])
  chartImage              ChartImage? @relation(fields: [chartImageId], references: [id])
}
